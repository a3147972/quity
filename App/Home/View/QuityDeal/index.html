
<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <!-- Title and other stuffs -->
  <title>{:C('TITLE')}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="author" content="">
  <include file="Public/style" />
</head>
<body>
<include file="Public/header" />

<!-- Main content starts -->

<div class="content">

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-dropdown"><a href="#">导航</a></div>

        <!--- Sidebar navigation -->
        <!-- If the main navigation has sub navigation, then add the class "has_sub" to "li" of main navigation. -->
        <include file="Public/menu" />
    </div>

    <!-- Sidebar ends -->

        <!-- Main bar -->
    <div class="mainbar">

        <!-- Page heading -->
        <div class="page-head">
          <h2 class="pull-left"><i class="icon-home"></i> 股权交易</h2>
        <div class="clearfix"></div>
        </div>
        <!-- Page heading ends -->
        <!-- Matter -->

        <div class="matter">
        <div class="container">
          <div class="row">
            <div class="col-md-6">
              <div class="widget">
                <div class="widget-content">
                <div id="echart" style="height:400px">

                </div>
              </div>
              </div>
            </div>
            <div class="col-md-6">
            <div class="widget">
              <div class="widget-content">
                <table class="table table-striped table-bordered table-hover">
                      <tbody>
                        <volist name="deal_list" id="deal_vo">
                          <tr>
                              <td>{$deal_vo.quity_count}</td>
                              <td>{$deal_vo.then_balance}</td>
                          </tr>
                        </volist>
                      </tbody>
                    </table>
              </div>
            </div>

            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <a href="{:U('add')}" class="btn btn-success">发起交易</a>
              <div class="widget">
                <div class="widget-head">
                  <div class="pull-left">股权交易</div>
                  <div class="widget-icons pull-right">
                    <a href="#" class="wminimize"><i class="icon-chevron-up"></i></a>
                  </div>
                  <div class="clearfix"></div>
                </div>
                <div class="widget-content">
                  <table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <th>编号</th>
                          <th>发起人</th>
                          <th>股权数量</th>
                          <th>当时股权单价</th>
                          <th>交易类型</th>
                          <th>过期时间</th>
                          <th>操作</th>
                        </tr>
                      </thead>
                      <tbody>
                        <volist name="list" id="vo">
                          <tr>
                            <td>{$vo.id}</td>
                            <td>{$vo.member_id}</td>
                            <td>{$vo.quity_count}</td>
                            <td>{$vo.then_balance}</td>
                            <td>
                              <switch name="vo.option">
                                <case value="1">买入</case>
                                <case value="2">卖出</case>
                              </switch>
                            </td>
                            <td>{$vo.overdue_time}</td>
                            <td>
                              <if condition="$vo['member_id'] neq session('uid')">
                                <a href="#" _href="{:U('QuityDeal/buy', array('id' => $vo['id']))}" onclick="return DialogConfirm(this)">买入</a>
                              </if>
                            </td>
                          </tr>
                        </volist>
                      </tbody>
                  </table>
                  <div class="widget-foot">
                    <ul class="pagination">
                      <volist name="page_list" id="page_vo">
                        <switch name="page_vo.name">
                          <case value="prev">
                            <li><a href="{$page_vo.url}">Prev</a></li>
                          </case>
                          <case value="list">
                            <li><a href="{$page_vo.url}">{$page_vo.page}</a></li>
                          </case>
                          <case value="next">
                            <li><a href="{$page_vo.url}">Next</a></li>
                          </case>
                        </switch>
                      </volist>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
          </div>
    </div>
   <!-- Mainbar ends -->
   <div class="clearfix"></div>
</div>
<!-- Content ends -->
<include file="Public/footer" />

<include file="Public/script" />
<script>
  // 路径配置
        require.config({
            paths: {
                echarts: 'http://echarts.baidu.com/build/dist'
            }
        });
        var dateJson = {$quity_balance_date};
        var quity_balanceJson = {$quity_balance};
        var date = new Array();

        $.each(dateJson, function(i,e) {
          date.push(e);
        })
        var balance = new Array();

        $.each(quity_balanceJson, function(i,e){
          balance.push(e);
        })
        // 使用
        require(
            [
                'echarts',
                'echarts/chart/line'
            ],
            function (ec) {
                // 基于准备好的dom，初始化echarts图表
                var myChart = ec.init(document.getElementById('echart'));

                var option = {
                    tooltip: {
                        show: true
                    },
                    xAxis : [
                        {
                            type : 'category',
                            data : date,
                        }
                    ],
                    yAxis : [
                        {
                            type : 'value'
                        }
                    ],
                    series : [
                        {
                            "name":"销量",
                            "type":"bar",
                            "data":balance,
                            'type' : 'line',
                        }
                    ]
                };

                // 为echarts对象加载数据
                myChart.setOption(option);
            }
        );
</script>
</body>
</html>